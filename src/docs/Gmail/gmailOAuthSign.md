–ü—Ä–æ—Ü–µ—Å –æ—Ç—Ä–∏–º–∞–Ω–Ω—è "Refresh Token" –¥–ª—è –ø—Ä–æ–¥–∞–∫—à–µ–Ω—É ‚Äî —Ü–µ –æ–¥–Ω–æ—Ä–∞–∑–æ–≤–∞ –¥—ñ—è, —è–∫—É –≤–∏ (—Ä–æ–∑—Ä–æ–±–Ω–∏–∫) –≤–∏–∫–æ–Ω—É—î—Ç–µ –Ω–∞ —Å–≤–æ—î–º—É –ª–æ–∫–∞–ª—å–Ω–æ–º—É –∫–æ–º–ø'—é—Ç–µ—Ä—ñ, —â–æ–± "–∞–≤—Ç–æ—Ä–∏–∑—É–≤–∞—Ç–∏" –≤–∞—à —Å–µ—Ä–≤–µ—Ä.

–û—Å—å –ø–æ–∫—Ä–æ–∫–æ–≤–∞ —ñ–Ω—Å—Ç—Ä—É–∫—Ü—ñ—è –¥–ª—è –ø—Ä–æ–¥–∞–∫—à–µ–Ω—É.

# 1. üè≠ –ö—Ä–æ–∫ 1: –ù–∞–ª–∞—à—Ç—É–≤–∞–Ω–Ω—è Google Cloud Console (–í–∞–∂–ª–∏–≤–æ)

–ü–µ—Ä—à –Ω—ñ–∂ –≥–µ–Ω–µ—Ä—É–≤–∞—Ç–∏ —Ç–æ–∫–µ–Ω, –ø–µ—Ä–µ–∫–æ–Ω–∞–π—Ç–µ—Å—è, —â–æ –≤–∞—à –¥–æ–¥–∞—Ç–æ–∫ —É Google Cloud Console –Ω–∞–ª–∞—à—Ç–æ–≤–∞–Ω–∏–π –¥–ª—è –ø—Ä–æ–¥–∞–∫—à–µ–Ω—É.

–ü–µ—Ä–µ–π–¥—ñ—Ç—å –¥–æ Google Cloud Console -> "APIs & Services" -> "OAuth consent screen".

Publishing status (–°—Ç–∞—Ç—É—Å –ø—É–±–ª—ñ–∫–∞—Ü—ñ—ó):

–Ø–∫—â–æ —Å—Ç–æ—ó—Ç—å "Testing", –≤–∞—à Refresh Token –±—É–¥–µ –¥—ñ–π—Å–Ω–∏–π –ª–∏—à–µ 7 –¥–Ω—ñ–≤.

–ó–º—ñ–Ω—ñ—Ç—å —Å—Ç–∞—Ç—É—Å –Ω–∞ "In production". –¶–µ —Ä–æ–±–∏—Ç—å –≤–∞—à Refresh Token –¥–æ–≤–≥–æ—Ç—Ä–∏–≤–∞–ª–∏–º (–≤—ñ–Ω –≤—Å–µ —â–µ –º–æ–∂–µ –±—É—Ç–∏ –∞–Ω—É–ª—å–æ–≤–∞–Ω–∏–π, –∞–ª–µ –Ω–µ –∑–∞–∫—ñ–Ω—á–∏—Ç—å—Å—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–Ω–æ).

–ü–µ—Ä–µ–π–¥—ñ—Ç—å –¥–æ "Credentials" (–û–±–ª—ñ–∫–æ–≤—ñ –¥–∞–Ω—ñ):

–í–∏–±–µ—Ä—ñ—Ç—å –≤–∞—à "OAuth 2.0 Client ID".

–ü–µ—Ä–µ–∫–æ–Ω–∞–π—Ç–µ—Å—è, —â–æ –≤ "Authorized redirect URIs" –¥–æ–¥–∞–Ω–æ https://developers.google.com/oauthplayground.

# 2. üßë‚Äçüíª –ö—Ä–æ–∫ 2: –ì–µ–Ω–µ—Ä–∞—Ü—ñ—è —Ç–æ–∫–µ–Ω–∞ –Ω–∞ –≤–∞—à—ñ–π –ª–æ–∫–∞–ª—å–Ω—ñ–π –º–∞—à–∏–Ω—ñ

–í–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É–π—Ç–µ OAuth 2.0 Playground –≤—ñ–¥ Google. –¶–µ —ñ–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç, —è–∫–∏–π —Å–∏–º—É–ª—é—î –ø—Ä–æ—Ü–µ—Å –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü—ñ—ó.

–í—ñ–¥–∫—Ä–∏–π—Ç–µ OAuth 2.0 Playground.

–ù–∞—Ç–∏—Å–Ω—ñ—Ç—å –Ω–∞ —ñ–∫–æ–Ω–∫—É —à–µ—Å—Ç—ñ—Ä–Ω—ñ (–ù–∞–ª–∞—à—Ç—É–≤–∞–Ω–Ω—è) –ø—Ä–∞–≤–æ—Ä—É—á.

–ü–æ—Å—Ç–∞–≤—Ç–µ –≥–∞–ª–æ—á–∫—É "Use your own OAuth credentials".

–í–≤–µ–¥—ñ—Ç—å Client ID —Ç–∞ Client Secret –∑ –≤–∞—à–æ–≥–æ –ø—Ä–æ–¥–∞–∫—à–µ–Ω-–¥–æ–¥–∞—Ç–∫—É –≤ Google Cloud.

–ê–≤—Ç–æ—Ä–∏–∑—É–π—Ç–µ API:

–ó–ª—ñ–≤–∞, —É –ø–æ–ª—ñ "Select & authorize APIs", –≤–≤–µ–¥—ñ—Ç—å https://mail.google.com/ —ñ –Ω–∞—Ç–∏—Å–Ω—ñ—Ç—å "Authorize APIs".

–£–≤—ñ–π–¥—ñ—Ç—å –≤ –∞–∫–∞—É–Ω—Ç:

–í–∞—Å –ø–µ—Ä–µ–Ω–∞–ø—Ä–∞–≤–∏—Ç—å –Ω–∞ —Å—Ç–æ—Ä—ñ–Ω–∫—É –≤—Ö–æ–¥—É Google. –£–≤—ñ–π–¥—ñ—Ç—å –≤ –∞–∫–∞—É–Ω—Ç, –∑ —è–∫–æ–≥–æ –≤–∞—à —Å–µ—Ä–≤–µ—Ä –±—É–¥–µ –Ω–∞–¥—Å–∏–ª–∞—Ç–∏ –ª–∏—Å—Ç–∏ (—Ç–æ–π, —â–æ –≤–∫–∞–∑–∞–Ω–∏–π —É GMAIL_USER).

–ù–∞–¥–∞–π—Ç–µ –¥–æ–∑–≤—ñ–ª ("Allow") –≤–∞—à–æ–º—É –¥–æ–¥–∞—Ç–∫—É.

–û—Ç—Ä–∏–º–∞–π—Ç–µ —Ç–æ–∫–µ–Ω–∏:

–í–∞—Å –ø–æ–≤–µ—Ä–Ω–µ –Ω–∞–∑–∞–¥ –¥–æ Playground. –ù–∞—Ç–∏—Å–Ω—ñ—Ç—å "Exchange authorization code for tokens".

### –ü—Ä–∞–≤–æ—Ä—É—á –≤–∏ –ø–æ–±–∞—á–∏—Ç–µ Access token (–¥—ñ–π—Å–Ω–∏–π 1 –≥–æ–¥–∏–Ω—É) —ñ Refresh token (—Ü–µ —Ç–æ–π, —â–æ –≤–∞–º –ø–æ—Ç—Ä—ñ–±–µ–Ω).

# 3. üîí –ö—Ä–æ–∫ 3: –ó–±–µ—Ä–µ–∂–µ–Ω–Ω—è —Ç–æ–∫–µ–Ω–∞ –Ω–∞ –≤–∞—à–æ–º—É —Å–µ—Ä–≤–µ—Ä—ñ

–°–∫–æ–ø—ñ—é–π—Ç–µ –æ—Ç—Ä–∏–º–∞–Ω–∏–π Refresh token.

–ù—ñ–∫–æ–ª–∏ –Ω–µ –∑–±–µ—Ä—ñ–≥–∞–π—Ç–µ –π–æ–≥–æ –≤ –∫–æ–¥—ñ!

–ü—ñ–¥–∫–ª—é—á—ñ—Ç—å—Å—è –¥–æ –≤–∞—à–æ–≥–æ "—Ä–µ–º–æ—É—Ç" —Å–µ—Ä–≤–µ—Ä–∞.

–ó–±–µ—Ä–µ–∂—ñ—Ç—å —Ü–µ–π —Ç–æ–∫–µ–Ω —è–∫ –∑–º—ñ–Ω–Ω—É –æ—Ç–æ—á–µ–Ω–Ω—è (environment variable). –¶–µ —Ä–æ–±–∏—Ç—å—Å—è –ø–æ-—Ä—ñ–∑–Ω–æ–º—É –∑–∞–ª–µ–∂–Ω–æ –≤—ñ–¥ –≤–∞—à–æ–≥–æ —Ö–æ—Å—Ç–∏–Ω–≥—É (Heroku, Vercel, DigitalOcean, AWS):

Vercel/Netlify: –£ –Ω–∞–ª–∞—à—Ç—É–≤–∞–Ω–Ω—è—Ö –ø—Ä–æ–µ–∫—Ç—É -> "Environment Variables".

Linux-—Å–µ—Ä–≤–µ—Ä (DigitalOcean, AWS): –£ —Ñ–∞–π–ª—ñ .env –≤–∞—à–æ–≥–æ –ø—Ä–æ–µ–∫—Ç—É.

Bash

# –£ –≤–∞—à–æ–º—É .env —Ñ–∞–π–ª—ñ –Ω–∞ —Å–µ—Ä–≤–µ—Ä—ñ

```
GMAIL_USER=your_email@gmail.com
GMAIL_CLIENT_ID=your_production_client_id
GMAIL_CLIENT_SECRET=your_production_client_secret
GMAIL_REFRESH_TOKEN=1//...—Å–∫–æ–ø—ñ–π–æ–≤–∞–Ω–∏–π_–¥–æ–≤–≥–∏–π_—Ç–æ–∫–µ–Ω...
–û–Ω–æ–≤—ñ—Ç—å –≤–∞—à –∫–æ–¥ Node.js, —â–æ–± –≤—ñ–Ω —á–∏—Ç–∞–≤ —Ü—ñ –∑–º—ñ–Ω–Ω—ñ:

JavaScript

const nodemailer = require('nodemailer');

const mailTransport = nodemailer.createTransport({
  service: 'gmail',
  auth: {
    type: 'OAuth2',
    user: process.env.GMAIL_USER,
    clientId: process.env.GMAIL_CLIENT_ID,
    clientSecret: process.env.GMAIL_CLIENT_SECRET,
    refreshToken: process.env.GMAIL_REFRESH_TOKEN,
  },
});
```

–ü–µ—Ä–µ–∑–∞–ø—É—Å—Ç—ñ—Ç—å –≤–∞—à –¥–æ–¥–∞—Ç–æ–∫ –Ω–∞ —Å–µ—Ä–≤–µ—Ä—ñ, —â–æ–± –≤—ñ–Ω "–ø—ñ–¥—Ö–æ–ø–∏–≤" –Ω–æ–≤—ñ –∑–º—ñ–Ω–Ω—ñ –æ—Ç–æ—á–µ–Ω–Ω—è.

–¢–µ–ø–µ—Ä –≤–∞—à —Å–µ—Ä–≤–µ—Ä –±—É–¥–µ –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É–≤–∞—Ç–∏ Refresh Token –¥–ª—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–Ω–æ–≥–æ –æ—Ç—Ä–∏–º–∞–Ω–Ω—è –Ω–æ–≤–∏—Ö Access Token –∫–æ–∂–Ω–æ–≥–æ —Ä–∞–∑—É, –∫–æ–ª–∏ –π–æ–º—É –ø–æ—Ç—Ä—ñ–±–Ω–æ –±—É–¥–µ –Ω–∞–¥—ñ—Å–ª–∞—Ç–∏ –ª–∏—Å—Ç.
